<!DOCTYPE html>
<html>
<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

<style>

#preview > div {
    text-align: center;    
    color: blue;
    font-family: sans-serif;
}

</style>

</head>
<body>

  <div id="preview" style="width: 100%; height: 95vh;">
    <canvas id="gauge" style="width: 100%; height: 80%;"></canvas>
    <div id="preview-textfield" style="font-size: 3em; font-weight: bold;"></div>
    <div id="device-id" style="font-size: 2em;"></div>
  </div>

<script src="/gauge/gauge.min.js"></script>
<script src="/jquery/jquery.min.js"></script>

<script>

    var opts = {
        colorStart: "#6666AA",
        colorStop: "#6666AA",
        highDpiSupport: true
    };

    var selectGauge = new Gauge(document.getElementById("gauge")).setOptions(opts);
    selectGauge.setTextField(document.getElementById("preview-textfield"));
    selectGauge.animationSpeed = 20;
    selectGauge.maxValue = 5000;
    selectGauge.set(0);

    function refreshGauge()
    {
        $(function() {
            $.getJSON(
            "/power_consumption",
            function(json){ 
                // console.log(json)
                selectGauge.set(json.data.WHE);
                $("#device-id").text(json.deviceId);
            });
        });
    }
    setInterval( refreshGauge, 1000 );

</script>
</body>
</html>